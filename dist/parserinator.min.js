"use strict";!function(){function n(){var n={api_root:null,api_version:null};this.setOptions=function(r){angular.extend(n,r)},this.$get=[function(){function r(n){return 0===n.indexOf("http://")||0===n.indexOf("https://")}var t={generateApiUrl:function(n){var t=n.api_root,i=n.api_version,e=void 0;return t&&i?(e=t+"/"+i,r(t)?e:"http://"+e):void 0}};return t.full_api_url=t.generateApiUrl(n),t}]}function r(n,r,t){function i(n){return function(r){return _.findWhere(n,{id:r.id,type:r.type})}}function e(n){return n?"include="+n.join(","):""}function o(n){var r=[],t=void 0;if(!n)return"";for(t in n)n.hasOwnProperty(t)&&r.push("fields["+t+"]="+n[t].join(","));return r.join("&")}function u(n){{var r=n.includes;n.fields}return"?"+e(r)+"&"+o(n.fields)}function a(t,i){return function(e){var o=r.defer(),a=i||"",c=v+"/"+t,f=u(e),s=e.endpoint?"/"+e.endpoint:"";return c+=s+f+h,console.log("Request: "+c),n.jsonp(c,{cache:!0}).success(function(n){o.resolve(n)}).error(function(){o.reject(y+a)}),o.promise}}function c(n){var r=[];return _.each(n,function(n){r.push(f(n))}),r}function f(n){var r=angular.copy(n),t=r.relationships;return r=d(r,t)}function s(){}function l(n){var r={};return r=g(n),r&&r.relationships&&(r=d(r,r.relationship)),r}function p(n){var r=[],t={};return _.each(n,function(n){t=l(n),t?r.push(t):s()}),r}function d(n,r){var t={},i=[],e=void 0,o=void 0;for(var u in r)r.hasOwnProperty(u)&&(e=r[u].data,e&&(Array.isArray(e)?(o=e[0].type,i=p(e),i.length&&(n[o]=i)):(t=l(e),t?(o=e.type,n[o]=t):s())));return n}var v=t.full_api_url,h="&callback=JSON_CALLBACK",y="Could not reach API",A={},g=void 0;return A.get=function(n,r){return a(n,r)},A.parse=function(n){var r=n.data,t=n.included?n.included:[],e=void 0;return g=i(t),e=Array.isArray(r)?c(r):f(r)},A}r.$inject=["$http","$q","$jsonAPI"],angular.module("parserinator",[]).provider("$jsonAPI",n).factory("jsonAPIParser",r)}();